<?php
/*
 * @ https://github.com/CMSNTSourceCode
 * @ Meo Mat Cang
 * @ PHP 7.4
 * @ Telegram : @Mo_Ho_Bo
 */
if(!defined("IN_SITE")) {
    exit("The Request Not Found");
}
$body = ["title" => __("Dashboard") . " | " . $CMSNT->site("title"), "desc" => $CMSNT->site("description"), "keyword" => $CMSNT->site("keywords")];
$body["header"] = "\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js\"></script>\n";
$body["footer"] = "\n \n \n";
require_once __DIR__ . "/../../models/is_admin.php";
require_once __DIR__ . "/header.php";
require_once __DIR__ . "/sidebar.php";
echo "<div class=\"main-content app-content\">\n    <div class=\"container-fluid\">\n        <div class=\"d-md-flex d-block align-items-center justify-content-between my-2 page-header-breadcrumb\">\n\n        </div>\n        ";
if(checkPermission($getUser["admin"], "view_license")) {
    echo "        <div class=\"alert alert-secondary alert-dismissible fade show custom-alert-icon shadow-sm\" role=\"alert\">\n            <div class=\"d-flex align-items-center mb-3\">\n                <i class=\"fas fa-code-branch text-primary me-2\"></i>\n                <h5 class=\"mb-0\">";
    echo $config["project"];
    echo " <span class=\"badge bg-primary\">";
    echo $config["version"];
    echo "</span></h5>\n            </div>\n            ";
    if($CMSNT->site("status_update") == 1) {
        echo "            <div class=\"alert alert-light border-0 py-2\">\n                <i class=\"fas fa-sync-alt text-success me-1\"></i>\n                <small>Hệ thống sẽ tự động cập nhật phiên bản mới khi bạn truy cập trang này. Để tắt tính năng này, vào \n                <strong>Cài Đặt</strong> &rarr; <strong>Cài đặt chung</strong> &rarr; <strong>Cập nhật phiên bản tự động</strong> &rarr; <strong>OFF</strong>.</small>\n            </div>\n            ";
    } else {
        echo "            <div class=\"alert alert-light border-0 py-2\">\n                <i class=\"fas fa-sync-alt text-danger me-1\"></i>\n                <small>Bạn đang tắt chức năng cập nhật phiên bản. Để bật tính năng này, vào \n                <strong>Cài Đặt</strong> &rarr; <strong>Cài đặt chung</strong> &rarr; <strong>Cập nhật phiên bản tự động</strong> &rarr; <strong>ON</strong>.</small>\n            </div>\n            ";
    }
    echo "            \n            <div class=\"mt-3\">\n                <div class=\"row g-2 mt-2\">\n                    <div class=\"col-md-6\">\n                        <div class=\"p-2 bg-light\">\n                            <i class=\"fab fa-telegram text-primary me-2\"></i>\n                            <small>Kênh thông báo cập nhật:</small>\n                            ";
    echo $CMSNT->site("status_demo") == 1 ? "<span class=\"badge bg-warning\">Chỉ áp dụng cho website chính hãng</span>" : "<a href=\"https://t.me/cmsntco\" target=\"_blank\">[CMSNT] Changelog - Notification</a>";
    echo "                        </div>\n                    </div>\n                    <div class=\"col-md-6\">\n                        <div class=\"p-2 bg-light\">\n                            <i class=\"fab fa-telegram text-primary me-2\"></i>\n                            <small>Nhóm tìm kiếm API:</small>\n                            ";
    echo $CMSNT->site("status_demo") == 1 ? "<span class=\"badge bg-warning\">Chỉ áp dụng cho website chính hãng</span>" : "<a href=\"https://t.me/+LVON7y2BKWU3ZDY9\" target=\"_blank\">[CMSNT] Tìm kiếm API - Suppliers</a>";
    echo "                        </div>\n                    </div>\n                    <div class=\"col-md-6\">\n                        <div class=\"p-2 bg-light\">\n                            <i class=\"fab fa-rocketchat text-success me-2\"></i>\n                            <small>Nhóm Zalo thông báo:</small>\n                            ";
    echo $CMSNT->site("status_demo") == 1 ? "<span class=\"badge bg-warning\">Chỉ áp dụng cho website chính hãng</span>" : "<a href=\"https://zalo.me/g/idapcx933\" target=\"_blank\">[CMSNT] Changelog - Notification</a>";
    echo "                        </div>\n                    </div>\n                    <div class=\"col-md-6\">\n                        <div class=\"p-2 bg-light\">\n                            <i class=\"fab fa-rocketchat text-success me-2\"></i>\n                            <small>Nhóm Zalo trao đổi API:</small>\n                            ";
    echo $CMSNT->site("status_demo") == 1 ? "<span class=\"badge bg-warning\">Chỉ áp dụng cho website chính hãng</span>" : "<a href=\"https://zalo.me/g/eululb377\" target=\"_blank\">[CMSNT] Trao đổi API - Suppliers</a>";
    echo "                        </div>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"d-flex gap-2 mt-3\">\n                <a class=\"btn btn-primary btn-sm\" href=\"https://www.messenger.com/t/101939031161934?ref=kiemtrabanquyenwebsite\" target=\"_blank\">\n                    <i class=\"fab fa-facebook-messenger me-1\"></i> Kiểm tra bản quyền\n                </a>\n                <a class=\"btn btn-secondary btn-sm\" href=\"https://t.me/cmsnt_bot\" target=\"_blank\">\n                    <i class=\"fab fa-telegram me-1\"></i> Bot kiểm tra bản quyền\n                </a>\n                <button class=\"btn btn-info btn-sm\" id=\"copyLicenseKey\" onclick=\"copyLicenseKey()\">\n                    <i class=\"fas fa-copy me-1\"></i> Sao chép giấy phép\n                </button>\n                <button class=\"btn btn-warning btn-sm ms-auto\" id=\"hideAlert24h\">\n                    <i class=\"fas fa-eye-slash me-1\"></i> Ẩn trong 24 giờ\n                </button>\n                <script>\n                    function copyLicenseKey() {\n                        const licenseKey = '";
    echo $CMSNT->site("license_key");
    echo "';\n                        navigator.clipboard.writeText(licenseKey).then(function() {\n                            // Hiển thị thông báo thành công\n                            const button = document.getElementById('copyLicenseKey');\n                            const originalText = button.innerHTML;\n                            button.innerHTML = '<i class=\"fas fa-check me-1\"></i> Đã sao chép';\n                            button.classList.remove('btn-info');\n                            button.classList.add('btn-success');\n                            \n                            // Khôi phục lại trạng thái ban đầu sau 2 giây\n                            setTimeout(function() {\n                                button.innerHTML = originalText;\n                                button.classList.remove('btn-success');\n                                button.classList.add('btn-info');\n                            }, 2000);\n                        }).catch(function(err) {\n                            console.error('Không thể sao chép: ', err);\n                            alert('Không thể sao chép giấy phép. Vui lòng thử lại.');\n                        });\n                    }\n                </script>\n            </div>\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\" aria-label=\"Close\"></button>\n        </div>\n        <script>\n            document.getElementById('hideAlert24h').addEventListener('click', function() {\n                // Lưu thời gian ẩn vào localStorage\n                localStorage.setItem('hideAlertUntil', Date.now() + 24 * 60 * 60 * 1000);\n                // Ẩn thông báo\n                this.closest('.alert').style.display = 'none';\n            });\n            \n            // Kiểm tra xem thông báo có nên hiển thị không khi trang tải\n            document.addEventListener('DOMContentLoaded', function() {\n                const hideUntil = localStorage.getItem('hideAlertUntil');\n                const alertElement = document.querySelector('.alert-secondary');\n                \n                if (hideUntil && Date.now() < parseInt(hideUntil) && alertElement) {\n                    alertElement.style.display = 'none';\n                }\n            });\n        </script>\n        ";
}
echo "        ";
if($CMSNT->site("smtp_status") != 1) {
    echo "        <div class=\"alert alert-warning alert-dismissible fade show custom-alert-icon shadow-sm\" role=\"alert\">\n            <svg class=\"svg-warning\" xmlns=\"http://www.w3.org/2000/svg\" height=\"1.5rem\" viewBox=\"0 0 24 24\"\n                width=\"1.5rem\" fill=\"#000000\">\n                <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n                <path d=\"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z\" />\n            </svg>\n            Vui lòng cấu hình <b>SMTP</b> để sử dụng toàn bộ tiện ích từ Mail:\n            <a class=\"text-primary\"\n                href=\"https://help.cmsnt.co/huong-dan/huong-dan-cau-hinh-smtp-vao-website-shopclone7/\"\n                target=\"_blank\">Xem Hướng Dẫn</a>\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\" aria-label=\"Close\"><i\n                    class=\"bi bi-x\"></i></button>\n        </div>\n        ";
}
echo "        ";
if($CMSNT->site("debug_auto_bank") == 1) {
    echo "        <div class=\"alert alert-danger alert-dismissible fade show custom-alert-icon shadow-sm\" role=\"alert\">\n            <svg class=\"svg-danger\" xmlns=\"http://www.w3.org/2000/svg\" height=\"1.5rem\" viewBox=\"0 0 24 24\"\n                width=\"1.5rem\" fill=\"#000000\">\n                <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n                <path\n                    d=\"M15.73 3H8.27L3 8.27v7.46L8.27 21h7.46L21 15.73V8.27L15.73 3zM12 17.3c-.72 0-1.3-.58-1.3-1.3 0-.72.58-1.3 1.3-1.3.72 0 1.3.58 1.3 1.3 0 .72-.58 1.3-1.3 1.3zm1-4.3h-2V7h2v6z\" />\n            </svg>\n            Vui lòng tắt chức năng <b>Debug Auto Bank</b> khi không gặp vấn đề về Auto Bank. Tắt chức năng này trong Cài\n            Đặt -> ON/OFF Debug Auto Bank\n            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\" aria-label=\"Close\"><i\n                    class=\"bi bi-x\"></i></button>\n        </div>\n        ";
}
echo "        <div class=\"row\">\n            ";
if(checkPermission($getUser["admin"], "view_statistical")) {
    echo "            <div class=\"col-12\">\n                <div class=\"text-right mb-3\">\n                    <img src=\"";
    echo base_url("mod/img/gif-live.gif");
    echo "\" width=\"60px\">\n                </div>\n            </div>\n            <!-- Thành viên đăng ký toàn thời gian -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card primary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-primary\">\n                                    <i class=\"fa-solid fa-users fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Thành viên đăng ký</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_users_all\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-primary-transparent\">Toàn thời gian</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Đơn hàng đã bán toàn thời gian -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card secondary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-info\">\n                                    <i class=\"fa-solid fa-cart-shopping fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Đơn hàng đã bán</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_orders_all\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-info-transparent\">Toàn thời gian</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Doanh thu đơn hàng toàn thời gian -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card warning\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-warning\">\n                                    <i class=\"fa-solid fa-chart-simple fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Doanh thu đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_pay_all\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-warning-transparent\">Toàn thời gian</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Lợi nhuận đơn hàng toàn thời gian -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card danger\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-danger\">\n                                    <i class=\"fa-solid fa-money-bill-trend-up fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Lợi nhuận đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"profit_all\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-danger-transparent\">Toàn thời gian</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <!-- Thành viên đăng ký tháng này -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card primary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-primary\">\n                                    <i class=\"fa-solid fa-users fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Thành viên đăng ký</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"new_users_month\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-primary-transparent\">Tháng ";
    echo date("m", time());
    echo "</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <!-- Đơn hàng đã bán tháng này -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card secondary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-info\">\n                                    <i class=\"fa-solid fa-cart-shopping fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Đơn hàng đã bán</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_orders_month\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-info-transparent\">Tháng ";
    echo date("m", time());
    echo "</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n\n            <!-- Doanh thu đơn hàng tháng này -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card warning\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-warning\">\n                                    <i class=\"fa-solid fa-chart-simple fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Doanh thu đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_pay_month\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-warning-transparent\">Tháng ";
    echo date("m", time());
    echo "</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Lợi nhuận đơn hàng tháng này -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card danger\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-danger\">\n                                    <i class=\"fa-solid fa-money-bill-trend-up fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Lợi nhuận đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"profit_month\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-danger-transparent\">Tháng ";
    echo date("m", time());
    echo "</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n             <!-- Thành viên đăng ký tuần này -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card primary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-primary\">\n                                    <i class=\"fa-solid fa-users fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Thành viên đăng ký</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"new_users_week\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-primary-transparent\">Tuần này</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Đơn hàng đã bán tuần này -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card secondary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-info\">\n                                    <i class=\"fa-solid fa-cart-shopping fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Đơn hàng đã bán</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_orders_week\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-info-transparent\">Tuần này</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Doanh thu đơn hàng tuần này -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card warning\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-warning\">\n                                    <i class=\"fa-solid fa-chart-simple fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Doanh thu đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_pay_week\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-warning-transparent\">Tuần này</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Lợi nhuận đơn hàng tuần này -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card danger\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-danger\">\n                                    <i class=\"fa-solid fa-money-bill-trend-up fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Lợi nhuận đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"profit_week\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-danger-transparent\">Tuần này</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <!-- ========================= Kết thúc Thống kê tuần này ========================= -->\n\n\n            <!-- Thành viên đăng ký hôm nay -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card primary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-primary\">\n                                    <i class=\"fa-solid fa-users fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Thành viên đăng ký</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"new_users_today\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-primary-transparent\">Hôm nay</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <!-- Đơn hàng đã bán hôm nay -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card secondary\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-info\">\n                                    <i class=\"fa-solid fa-cart-shopping fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Đơn hàng đã bán</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_orders_today\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-info-transparent\">Hôm nay</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Doanh thu đơn hàng hôm nay -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card warning\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-warning\">\n                                    <i class=\"fa-solid fa-chart-simple fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Doanh thu đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"total_pay_today\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-warning-transparent\">Hôm nay</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Lợi nhuận đơn hàng hôm nay -->\n            <div class=\"col-xxl-3 col-xl-3 col-lg-6 col-md-6 col-sm-6\">\n                <div class=\"card custom-card hrm-main-card danger\">\n                    <div class=\"card-body\">\n                        <div class=\"d-flex align-items-top\">\n                            <div class=\"me-3\">\n                                <span class=\"avatar bg-danger\">\n                                    <i class=\"fa-solid fa-money-bill-trend-up fs-18\"></i>\n                                </span>\n                            </div>\n                            <div class=\"flex-fill\">\n                                <span class=\"fw-semibold text-muted d-block mb-2\">Lợi nhuận đơn hàng</span>\n                                <h5 class=\"fw-semibold mb-2\" id=\"profit_today\">\n                                    <div class=\"spinner\" style=\"display: none;\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i>\n                                    </div>\n                                </h5>\n                                <p class=\"mb-0\">\n                                    <span class=\"badge bg-danger-transparent\">Hôm nay</span>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <script>\n            function show_thong_ke_dashboard() {\n                \$.ajax({\n                    url: '";
    echo base_url("ajaxs/admin/view.php");
    echo "',\n                    method: 'POST',\n                    dataType: 'JSON',\n                    data: {\n                        action: 'show_thong_ke_dashboard',\n                        token: '";
    echo $getUser["token"];
    echo "'\n                    },\n                    beforeSend: function() {\n                        \$('.spinner').show(); // Hiển thị icon spin trước khi gửi yêu cầu\n                    },\n                    success: function(data) {\n                        if (data.status !== 'error') {\n                            // Cập nhật dữ liệu Toàn thời gian\n                            \$('#total_users_all').text(data.total_users_all);\n                            \$('#total_orders_all').text(data.total_orders_all);\n                            \$('#total_pay_all').text(data.total_pay_all);\n                            \$('#profit_all').text(data.profit_all);\n                            \n                            // Cập nhật dữ liệu Tháng này\n                            \$('#new_users_month').text(data.new_users_month);\n                            \$('#total_orders_month').text(data.total_orders_month);\n                            \$('#total_pay_month').text(data.total_pay_month);\n                            \$('#profit_month').text(data.profit_month);\n                            \n                            // Cập nhật dữ liệu Hôm nay\n                            \$('#new_users_today').text(data.new_users_today);\n                            \$('#total_orders_today').text(data.total_orders_today);\n                            \$('#total_pay_today').text(data.total_pay_today);\n                            \$('#profit_today').text(data.profit_today);\n                            \n                            // Cập nhật dữ liệu Tuần này\n                            \$('#new_users_week').text(data.new_users_week);\n                            \$('#total_orders_week').text(data.total_orders_week);\n                            \$('#total_pay_week').text(data.total_pay_week);\n                            \$('#profit_week').text(data.profit_week);\n                        } else {\n                            // Xử lý khi có lỗi từ phía backend\n                            alert(data.msg);\n                        }\n                    },\n                    complete: function() {\n                        \$('.spinner').hide(); // Ẩn icon spin sau khi hoàn thành yêu cầu\n                    },\n                    error: function(xhr, status, error) {\n                        console.error('AJAX Error:', error);\n                        \$('.spinner').hide(); // Ẩn icon spin trong trường hợp lỗi\n                    }\n                });\n            }\n\n            \$(document).ready(function() {\n                show_thong_ke_dashboard(); // Cập nhật dữ liệu ngay khi tải trang\n                setInterval(show_thong_ke_dashboard, 5000); // Cập nhật dữ liệu mỗi 5 giây\n            });\n        </script>\n\n\n            <div class=\"col-xl-6\">\n                <div class=\"card custom-card\">\n                    <div class=\"card-header d-flex align-items-center justify-content-between\">\n                        <h6 class=\"card-title mb-0\" id=\"chart-order-title\">THỐNG KÊ ĐƠN HÀNG THÁNG ";
    echo date("m");
    echo "</h6>\n                        <div class=\"dropdown\">\n                            <select id=\"chart-time-range\" class=\"form-select form-select-sm\">\n                                <option value=\"week\">7 ngày gần đây</option>\n                                <option value=\"month\" selected>Tháng ";
    echo date("m");
    echo "</option>\n                                <option value=\"year\">Năm ";
    echo date("Y");
    echo "</option>\n                            </select>\n                        </div>\n                    </div>\n                    <div class=\"card-body\">\n                        <!-- Thêm hiệu ứng loading cho chart đơn hàng -->\n                        <div id=\"chart-order-loader\" class=\"text-center py-5\" style=\"display: none;\">\n                            <div class=\"spinner-border text-primary\" role=\"status\">\n                                <span class=\"visually-hidden\">Đang tải...</span>\n                            </div>\n                            <div class=\"mt-2\">Đang tải dữ liệu biểu đồ...</div>\n                        </div>\n                        <canvas id=\"chartjs-line\" class=\"chartjs-chart\" style=\"height: 300px;\"></canvas>\n                        <script>\n                        (function() {\n                            document.addEventListener('DOMContentLoaded', function() {\n                                let myChart;\n                                \n                                function loadChartData(timeRange) {\n                                    // Cập nhật tiêu đề\n                                    let titleText;\n                                    switch(timeRange) {\n                                        case 'week':\n                                            titleText = 'THỐNG KÊ ĐƠN HÀNG 7 NGÀY GẦN ĐÂY';\n                                            break;\n                                        case 'month':\n                                            titleText = 'THỐNG KÊ ĐƠN HÀNG THÁNG ";
    echo date("m");
    echo "';\n                                            break;\n                                        case 'year':\n                                            titleText = 'THỐNG KÊ ĐƠN HÀNG NĂM ";
    echo date("Y");
    echo "';\n                                            break;\n                                    }\n                                    document.getElementById('chart-order-title').innerText = titleText;\n                                    \n                                    // Hiển thị loader và ẩn chart\n                                    document.getElementById('chart-order-loader').style.display = 'block';\n                                    document.getElementById('chartjs-line').style.opacity = '0';\n                                    \n                                    // Hủy biểu đồ cũ nếu tồn tại\n                                    if (myChart) {\n                                        myChart.destroy();\n                                    }\n                                    \n                                    // Gọi API lấy dữ liệu mới\n                                    \$.ajax({\n                                        url: '";
    echo base_url("ajaxs/admin/view.php");
    echo "',\n                                        method: 'POST',\n                                        dataType: 'json',\n                                        data: {\n                                            action: 'view_chart_thong_ke_don_hang',\n                                            token: '";
    echo $getUser["token"];
    echo "',\n                                            time_range: timeRange\n                                        },\n                                        success: function(response) {\n                                            // Ẩn loader và hiển thị biểu đồ\n                                            document.getElementById('chart-order-loader').style.display = 'none';\n                                            document.getElementById('chartjs-line').style.opacity = '1';\n                                            \n                                            const labels = response.labels;\n                                            const revenues = response.revenues;\n                                            const profits = response.profits;\n                                            const data = {\n                                                labels: labels,\n                                                datasets: [{\n                                                        label: 'Lợi nhuận (VNĐ)',\n                                                        backgroundColor: 'rgb(73,182,245)',\n                                                        borderColor: 'rgb(73,182,245)',\n                                                        data: profits,\n                                                    },\n                                                    {\n                                                        label: 'Doanh thu (VNĐ)',\n                                                        backgroundColor: 'rgb(132, 90, 223)',\n                                                        borderColor: 'rgb(132, 90, 223)',\n                                                        data: revenues,\n                                                    }\n                                                ]\n                                            };\n                                            const config = {\n                                                type: 'bar',\n                                                data: data,\n                                                options: {\n                                                    responsive: true,\n                                                    maintainAspectRatio: false\n                                                }\n                                            };\n                                            myChart = new Chart(\n                                                document.getElementById('chartjs-line'),\n                                                config\n                                            );\n                                        },\n                                        error: function() {\n                                            // Ẩn loader khi có lỗi\n                                            document.getElementById('chart-order-loader').style.display = 'none';\n                                            document.getElementById('chartjs-line').style.opacity = '1';\n                                            \n                                            // Hiển thị biểu đồ thông báo lỗi\n                                            const config = {\n                                                type: 'bar',\n                                                data: {\n                                                    labels: ['Không có dữ liệu'],\n                                                    datasets: []\n                                                },\n                                                options: {\n                                                    responsive: true,\n                                                    maintainAspectRatio: false,\n                                                    plugins: {\n                                                        title: {\n                                                            display: true,\n                                                            text: 'Không thể tải dữ liệu biểu đồ. Vui lòng thử lại sau.',\n                                                            color: '#dc3545',\n                                                            font: {\n                                                                size: 16\n                                                            }\n                                                        }\n                                                    }\n                                                }\n                                            };\n                                            \n                                            myChart = new Chart(\n                                                document.getElementById('chartjs-line'),\n                                                config\n                                            );\n                                        }\n                                    });\n                                }\n                                \n                                // Xử lý sự kiện khi người dùng thay đổi khoảng thời gian\n                                document.getElementById('chart-time-range').addEventListener('change', function() {\n                                    loadChartData(this.value);\n                                });\n                                \n                                // Khởi tạo biểu đồ với tháng hiện tại\n                                setTimeout(function() {\n                                    Chart.defaults.borderColor = \"rgba(142, 156, 173,0.1)\";\n                                    Chart.defaults.color = \"#8c9097\";\n                                    loadChartData('month');\n                                }, 5);\n                            });\n                        })();\n                        </script>\n                    </div>\n                </div>\n            </div>\n\n            <div class=\"col-xl-6\">\n                <div class=\"card custom-card\">\n                    <div class=\"card-header d-flex align-items-center justify-content-between\">\n                        <h6 class=\"card-title mb-0\" id=\"chart-deposit-title\">THỐNG KÊ NẠP TIỀN THÁNG ";
    echo date("m");
    echo "</h6>\n                        <div class=\"dropdown\">\n                            <select id=\"chart-deposit-time-range\" class=\"form-select form-select-sm\">\n                                <option value=\"week\">7 ngày gần đây</option>\n                                <option value=\"month\" selected>Tháng ";
    echo date("m");
    echo "</option>\n                                <option value=\"year\">Năm ";
    echo date("Y");
    echo "</option>\n                            </select>\n                        </div>\n                    </div>\n                    <div class=\"card-body\">\n                        <!-- Thêm hiệu ứng loading cho chart nạp tiền -->\n                        <div id=\"chart-deposit-loader\" class=\"text-center py-5\" style=\"display: none;\">\n                            <div class=\"spinner-border text-primary\" role=\"status\">\n                                <span class=\"visually-hidden\">Đang tải...</span>\n                            </div>\n                            <div class=\"mt-2\">Đang tải dữ liệu biểu đồ...</div>\n                        </div>\n                        <canvas id=\"chartjs-naptien\" class=\"chartjs-chart\" style=\"height: 300px;\"></canvas>\n                        <script>\n                        (function() {\n                            document.addEventListener('DOMContentLoaded', function() {\n                                let myChart;\n                                \n                                function loadChartData(timeRange) {\n                                    // Cập nhật tiêu đề\n                                    let titleText;\n                                    switch(timeRange) {\n                                        case 'week':\n                                            titleText = 'THỐNG KÊ NẠP TIỀN 7 NGÀY GẦN ĐÂY';\n                                            break;\n                                        case 'month':\n                                            titleText = 'THỐNG KÊ NẠP TIỀN THÁNG ";
    echo date("m");
    echo "';\n                                            break;\n                                        case 'year':\n                                            titleText = 'THỐNG KÊ NẠP TIỀN NĂM ";
    echo date("Y");
    echo "';\n                                            break;\n                                    }\n                                    document.getElementById('chart-deposit-title').innerText = titleText;\n                                    \n                                    // Hiển thị loader và ẩn chart\n                                    document.getElementById('chart-deposit-loader').style.display = 'block';\n                                    document.getElementById('chartjs-naptien').style.opacity = '0';\n                                    \n                                    // Hủy biểu đồ cũ nếu tồn tại\n                                    if (myChart) {\n                                        myChart.destroy();\n                                    }\n                                    \n                                    // Gọi API lấy dữ liệu mới\n                                    \$.ajax({\n                                        url: '";
    echo base_url("ajaxs/admin/view.php");
    echo "',\n                                        method: 'POST',\n                                        dataType: 'json',\n                                        data: {\n                                            action: 'view_chart_thong_ke_nap_tien',\n                                            token: '";
    echo $getUser["token"];
    echo "',\n                                            time_range: timeRange\n                                        },\n                                        success: function(response) {\n                                            // Ẩn loader và hiển thị biểu đồ\n                                            document.getElementById('chart-deposit-loader').style.display = 'none';\n                                            document.getElementById('chartjs-naptien').style.opacity = '1';\n                                            \n                                            const labels = response.labels;\n                                            const revenues = response.amount;\n                                            const data = {\n                                                labels: labels,\n                                                datasets: [{\n                                                    label: 'Doanh thu (VNĐ)',\n                                                    backgroundColor: 'rgb(29, 78, 216)',\n                                                    borderColor: 'rgb(29, 78, 216)',\n                                                    data: revenues,\n                                                }]\n                                            };\n                                            const config = {\n                                                type: 'bar',\n                                                data: data,\n                                                options: {\n                                                    responsive: true,\n                                                    maintainAspectRatio: false\n                                                }\n                                            };\n                                            myChart = new Chart(\n                                                document.getElementById('chartjs-naptien'),\n                                                config\n                                            );\n                                        },\n                                        error: function() {\n                                            // Ẩn loader khi có lỗi\n                                            document.getElementById('chart-deposit-loader').style.display = 'none';\n                                            document.getElementById('chartjs-naptien').style.opacity = '1';\n                                            \n                                            // Hiển thị biểu đồ thông báo lỗi\n                                            const config = {\n                                                type: 'bar',\n                                                data: {\n                                                    labels: ['Không có dữ liệu'],\n                                                    datasets: []\n                                                },\n                                                options: {\n                                                    responsive: true,\n                                                    maintainAspectRatio: false,\n                                                    plugins: {\n                                                        title: {\n                                                            display: true,\n                                                            text: 'Không thể tải dữ liệu biểu đồ. Vui lòng thử lại sau.',\n                                                            color: '#dc3545',\n                                                            font: {\n                                                                size: 16\n                                                            }\n                                                        }\n                                                    }\n                                                }\n                                            };\n                                            \n                                            myChart = new Chart(\n                                                document.getElementById('chartjs-naptien'),\n                                                config\n                                            );\n                                        }\n                                    });\n                                }\n                                \n                                // Xử lý sự kiện khi người dùng thay đổi khoảng thời gian\n                                document.getElementById('chart-deposit-time-range').addEventListener('change', function() {\n                                    loadChartData(this.value);\n                                });\n                                \n                                // Khởi tạo biểu đồ với tháng hiện tại\n                                setTimeout(function() {\n                                    Chart.defaults.borderColor = \"rgba(142, 156, 173,0.1)\";\n                                    Chart.defaults.color = \"#8c9097\";\n                                    loadChartData('month');\n                                }, 5);\n                            });\n                        })();\n                        </script>\n                    </div>\n                </div>\n            </div>\n\n\n\n            ";
}
echo "            ";
if(checkPermission($getUser["admin"], "view_recent_transactions")) {
    echo "            <div class=\"col-xl-6\">\n                <div class=\"card custom-card\">\n                    <div class=\"card-header\">\n                        <div class=\"card-title\">ĐƠN HÀNG GẦN ĐÂY</div>\n                        <div class=\"ms-auto\">\n                            <img class=\"text-right\" src=\"";
    echo base_url("mod/img/gif-live.gif");
    echo "\" width=\"60px\">\n                        </div>\n                    </div>\n                </div>\n                <ul class=\"timeline list-unstyled orders-timeline\"\n                    style=\"height:500px;overflow-x:hidden;overflow-y:auto;\">\n\n                </ul>\n            </div>\n            <div class=\"col-xl-6\">\n                <div class=\"card custom-card\">\n                    <div class=\"card-header\">\n                        <div class=\"card-title\">NẠP TIỀN GẦN ĐÂY</div>\n                        <div class=\"ms-auto\">\n                            <img class=\"text-right\" src=\"";
    echo base_url("mod/img/gif-live.gif");
    echo "\" width=\"60px\">\n                        </div>\n                    </div>\n                </div>\n                <ul class=\"timeline list-unstyled deposits-timeline\"\n                    style=\"height:500px;overflow-x:hidden;overflow-y:auto;\">\n\n                </ul>\n            </div>\n            <script>\n            function fetchOrders() {\n                \$.ajax({\n                    url: \"";
    echo base_url("ajaxs/admin/view.php");
    echo "\",\n                    method: 'POST',\n                    data: {\n                        action: 'view_don_hang_gan_day',\n                        token: '";
    echo $getUser["token"];
    echo "'\n                    },\n                    success: function(html) {\n                        \$('.orders-timeline').html(html);\n                    }\n                });\n            }\n\n            function fetchDeposits() {\n                \$.ajax({\n                    url: \"";
    echo base_url("ajaxs/admin/view.php");
    echo "\",\n                    method: 'POST',\n                    data: {\n                        action: 'view_nap_tien_gan_day',\n                        token: '";
    echo $getUser["token"];
    echo "'\n                    },\n                    success: function(html) {\n                        \$('.deposits-timeline').html(html);\n                    }\n                });\n            }\n            setInterval(fetchOrders, 5000);\n            setInterval(fetchDeposits, 5000);\n\n            \$(document).ready(function() {\n                fetchOrders();\n                fetchDeposits();\n            });\n            </script>\n            ";
}
echo "        </div>\n    </div>\n</div>\n\n\n";
require_once __DIR__ . "/footer.php";
echo "<script type=\"text/javascript\">\nnew ClipboardJS(\".copy\");\n\nfunction copy() {\n    showMessage('Đã sao chép vào bộ nhớ tạm', 'success');\n}\n</script>";

?>